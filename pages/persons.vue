<template>
    <div class="users-container">
        <div class="container">
            <div class="page-title-banner users">
                <h2><svg width="38" height="38" viewBox="0 0 38 38" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M25.5487 20.2768C27.3124 18.8892 28.5997 16.9863 29.2316 14.833C29.8635 12.6797 29.8085 10.383 29.0743 8.26235C28.3401 6.14173 26.9631 4.30269 25.1351 3.00108C23.307 1.69946 21.1187 1 18.8746 1C16.6304 1 14.4421 1.69946 12.614 3.00108C10.786 4.30269 9.40903 6.14173 8.67482 8.26235C7.9406 10.383 7.88561 12.6797 8.51749 14.833C9.14938 16.9863 10.4367 18.8892 12.2004 20.2768C9.17828 21.4876 6.54138 23.4957 4.57081 26.0873C2.60023 28.6788 1.36986 31.7565 1.01085 34.9923C0.984864 35.2285 1.00566 35.4676 1.07206 35.6958C1.13846 35.924 1.24915 36.1369 1.39783 36.3223C1.69809 36.6968 2.13481 36.9367 2.61193 36.9891C3.08904 37.0416 3.56746 36.9024 3.94195 36.6022C4.31643 36.3019 4.55629 35.8652 4.60878 35.3881C5.0038 31.8714 6.68062 28.6236 9.31886 26.2652C11.9571 23.9067 15.3718 22.6029 18.9105 22.6029C22.4493 22.6029 25.864 23.9067 28.5022 26.2652C31.1404 28.6236 32.8173 31.8714 33.2123 35.3881C33.2612 35.8301 33.4721 36.2384 33.8043 36.534C34.1366 36.8297 34.5665 36.9918 35.0112 36.9891H35.2091C35.6807 36.9349 36.1117 36.6964 36.4083 36.3258C36.7048 35.9551 36.8428 35.4823 36.7922 35.0103C36.4315 31.7653 35.1945 28.6797 33.2138 26.0842C31.2331 23.4887 28.5834 21.4811 25.5487 20.2768ZM18.8746 18.9995C17.4513 18.9995 16.0601 18.5775 14.8768 17.7868C13.6934 16.9961 12.7711 15.8723 12.2265 14.5574C11.6818 13.2425 11.5393 11.7957 11.817 10.3998C12.0946 9.00396 12.78 7.72179 13.7863 6.71543C14.7927 5.70907 16.0749 5.02373 17.4707 4.74608C18.8666 4.46843 20.3134 4.61093 21.6283 5.15556C22.9432 5.7002 24.067 6.62251 24.8577 7.80586C25.6484 8.98921 26.0704 10.3805 26.0704 11.8037C26.0704 13.7121 25.3123 15.5424 23.9628 16.8919C22.6133 18.2414 20.783 18.9995 18.8746 18.9995Z"
                            fill="white" stroke="white" />
                    </svg>
                    Persons
                </h2>
                <div class="banner-btns">
                    <button v-if="isAllowedToCreateProfile" @click="addNewProfile"   class="btn btn-success"><svg width="13" height="14" viewBox="0 0 13 14" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M7.69777 6.99797H3.49899C3.31339 6.99797 3.13539 7.0717 3.00415 7.20294C2.87292 7.33417 2.79919 7.51217 2.79919 7.69777C2.79919 7.88337 2.87292 8.06136 3.00415 8.1926C3.13539 8.32384 3.31339 8.39756 3.49899 8.39756H7.69777C7.88337 8.39756 8.06136 8.32384 8.1926 8.1926C8.32384 8.06136 8.39756 7.88337 8.39756 7.69777C8.39756 7.51217 8.32384 7.33417 8.1926 7.20294C8.06136 7.0717 7.88337 6.99797 7.69777 6.99797ZM11.4837 11.8966L12.3934 10.9938C12.5252 10.862 12.5992 10.6833 12.5992 10.497C12.5992 10.3106 12.5252 10.1319 12.3934 10.0001C12.2616 9.86833 12.0829 9.7943 11.8966 9.7943C11.7102 9.7943 11.5315 9.86833 11.3997 10.0001L10.497 10.9098L9.59422 10.0001C9.46244 9.86833 9.28372 9.7943 9.09736 9.7943C8.91101 9.7943 8.73228 9.86833 8.60051 10.0001C8.46873 10.1319 8.3947 10.3106 8.3947 10.497C8.3947 10.6833 8.46873 10.862 8.60051 10.9938L9.51024 11.8966L8.60051 12.7993C8.53491 12.8643 8.48285 12.9417 8.44733 13.027C8.4118 13.1123 8.39351 13.2038 8.39351 13.2961C8.39351 13.3885 8.4118 13.48 8.44733 13.5653C8.48285 13.6505 8.53491 13.7279 8.60051 13.793C8.66556 13.8586 8.74296 13.9107 8.82824 13.9462C8.91351 13.9817 9.00498 14 9.09736 14C9.18974 14 9.28121 13.9817 9.36649 13.9462C9.45177 13.9107 9.52916 13.8586 9.59422 13.793L10.497 12.8833L11.3997 13.793C11.4648 13.8586 11.5421 13.9107 11.6274 13.9462C11.7127 13.9817 11.8042 14 11.8966 14C11.9889 14 12.0804 13.9817 12.1657 13.9462C12.251 13.9107 12.3284 13.8586 12.3934 13.793C12.459 13.7279 12.5111 13.6505 12.5466 13.5653C12.5821 13.48 12.6004 13.3885 12.6004 13.2961C12.6004 13.2038 12.5821 13.1123 12.5466 13.027C12.5111 12.9417 12.459 12.8643 12.3934 12.7993L11.4837 11.8966ZM6.29817 12.5963H2.09939C1.91379 12.5963 1.7358 12.5226 1.60456 12.3914C1.47332 12.2601 1.39959 12.0821 1.39959 11.8966V2.09939C1.39959 1.91379 1.47332 1.7358 1.60456 1.60456C1.7358 1.47332 1.91379 1.39959 2.09939 1.39959H5.59838V3.49899C5.59838 4.05578 5.81956 4.58977 6.21327 4.98348C6.60699 5.37719 7.14097 5.59838 7.69777 5.59838H9.79716V7.69777C9.79716 7.88337 9.87089 8.06136 10.0021 8.1926C10.1334 8.32384 10.3114 8.39756 10.497 8.39756C10.6826 8.39756 10.8606 8.32384 10.9918 8.1926C11.123 8.06136 11.1968 7.88337 11.1968 7.69777V4.89858V4.85659C11.1895 4.7923 11.1754 4.72897 11.1548 4.66765V4.60466C11.1211 4.53271 11.0762 4.46657 11.0218 4.40872L6.82302 0.209939C6.76517 0.155506 6.69903 0.110625 6.62708 0.0769776C6.60393 0.0729254 6.58025 0.0729254 6.5571 0.0769776C6.48905 0.0405904 6.41592 0.0146411 6.34016 0H2.09939C1.5426 0 1.00861 0.221185 0.614898 0.614898C0.221185 1.00861 0 1.5426 0 2.09939V11.8966C0 12.4533 0.221185 12.9873 0.614898 13.381C1.00861 13.7748 1.5426 13.9959 2.09939 13.9959H6.29817C6.48377 13.9959 6.66177 13.9222 6.793 13.791C6.92424 13.6597 6.99797 13.4817 6.99797 13.2961C6.99797 13.1105 6.92424 12.9326 6.793 12.8013C6.66177 12.6701 6.48377 12.5963 6.29817 12.5963ZM6.99797 2.38631L8.81045 4.19878H7.69777C7.51217 4.19878 7.33417 4.12505 7.20294 3.99382C7.0717 3.86258 6.99797 3.68458 6.99797 3.49899V2.38631ZM3.49899 4.19878C3.31339 4.19878 3.13539 4.27251 3.00415 4.40375C2.87292 4.53499 2.79919 4.71298 2.79919 4.89858C2.79919 5.08418 2.87292 5.26217 3.00415 5.39341C3.13539 5.52465 3.31339 5.59838 3.49899 5.59838H4.19878C4.38438 5.59838 4.56238 5.52465 4.69361 5.39341C4.82485 5.26217 4.89858 5.08418 4.89858 4.89858C4.89858 4.71298 4.82485 4.53499 4.69361 4.40375C4.56238 4.27251 4.38438 4.19878 4.19878 4.19878H3.49899ZM6.29817 9.79716H3.49899C3.31339 9.79716 3.13539 9.87089 3.00415 10.0021C2.87292 10.1334 2.79919 10.3114 2.79919 10.497C2.79919 10.6826 2.87292 10.8606 3.00415 10.9918C3.13539 11.123 3.31339 11.1968 3.49899 11.1968H6.29817C6.48377 11.1968 6.66177 11.123 6.793 10.9918C6.92424 10.8606 6.99797 10.6826 6.99797 10.497C6.99797 10.3114 6.92424 10.1334 6.793 10.0021C6.66177 9.87089 6.48377 9.79716 6.29817 9.79716Z" fill="white"/>
                        </svg>
                            Add New Profile</button>
                </div>    
            </div>
            <div v-if="!showEmptyMessage" class="user-page">
                <div class="row">
                    <div class="col-md-3">
                        <div class="section-heading small blue">
                            <h4 class="ms-3"><svg width="18" height="18" viewBox="0 0 18 18" fill="none"
                                    xmlns="http://www.w3.org/2000/svg">
                                    <path
                                        d="M12.2744 9.63839C13.1562 8.94458 13.7999 7.99317 14.1158 6.91651C14.4317 5.83985 14.4043 4.69148 14.0371 3.63117C13.67 2.57087 12.9816 1.65135 12.0675 1.00054C11.1535 0.349732 10.0593 0 8.93728 0C7.81522 0 6.72106 0.349732 5.80702 1.00054C4.89298 1.65135 4.20451 2.57087 3.83741 3.63117C3.4703 4.69148 3.44281 5.83985 3.75875 6.91651C4.07469 7.99317 4.71836 8.94458 5.6002 9.63839C4.08914 10.2438 2.77069 11.2479 1.7854 12.5436C0.800116 13.8394 0.184929 15.3783 0.00542553 16.9961C-0.00756785 17.1143 0.00283191 17.2338 0.0360308 17.3479C0.0692296 17.462 0.124577 17.5684 0.198914 17.6612C0.349044 17.8484 0.567407 17.9683 0.805964 17.9946C1.04452 18.0208 1.28373 17.9512 1.47097 17.8011C1.65821 17.651 1.77815 17.4326 1.80439 17.194C2.0019 15.4357 2.84031 13.8118 4.15943 12.6326C5.47855 11.4533 7.18589 10.8014 8.95527 10.8014C10.7246 10.8014 12.432 11.4533 13.7511 12.6326C15.0702 13.8118 15.9086 15.4357 16.1061 17.194C16.1306 17.4151 16.2361 17.6192 16.4022 17.767C16.5683 17.9149 16.7833 17.9959 17.0056 17.9946H17.1046C17.3404 17.9674 17.5559 17.8482 17.7041 17.6629C17.8524 17.4776 17.9214 17.2411 17.8961 17.0051C17.7158 15.3827 17.0973 13.8399 16.1069 12.5421C15.1166 11.2443 13.7917 10.2406 12.2744 9.63839ZM8.93728 8.99976C8.22567 8.99976 7.53005 8.78874 6.93838 8.3934C6.3467 7.99805 5.88554 7.43613 5.61323 6.7787C5.34091 6.12126 5.26966 5.39784 5.40848 4.69991C5.54731 4.00198 5.88998 3.36089 6.39316 2.85771C6.89634 2.35453 7.53743 2.01187 8.23536 1.87304C8.93329 1.73421 9.65671 1.80546 10.3141 2.07778C10.9716 2.3501 11.5335 2.81126 11.9288 3.40293C12.3242 3.99461 12.5352 4.69023 12.5352 5.40183C12.5352 6.35606 12.1561 7.27121 11.4814 7.94595C10.8067 8.62069 9.89151 8.99976 8.93728 8.99976Z"
                                        fill="#1F1F1F" />
                                </svg>
                                Profiles</h4>
                        </div>
                        <div class="section-search mt-3">
                          <div class="form-group">
                            <div class="search-icon">
                              <svg
                                width="18"
                                height="18"
                                viewBox="0 0 18 18"
                                fill="none"
                                xmlns="http://www.w3.org/2000/svg"
                              >
                                <path
                                  fill-rule="evenodd"
                                  clip-rule="evenodd"
                                  d="M15.4196 18C14.7599 18 14.1273 17.7382 13.6605 17.2721L11.6842 15.2958L11.683 15.2946C11.3191 14.9225 11.0809 14.4455 11.0021 13.931C10.9232 13.4159 11.0079 12.889 11.2444 12.4246L11.3466 12.2237L10.1665 11.0435L9.95123 11.2047C8.6915 12.1474 7.12139 12.578 5.55697 12.4097C3.99255 12.2413 2.54998 11.4866 1.51966 10.2974C0.489337 9.10822 -0.0522314 7.57286 0.00397507 6.00041C0.0601816 4.42796 0.709989 2.93519 1.82259 1.82259C2.93519 0.709989 4.42796 0.0601816 6.00041 0.00397506C7.57286 -0.0522314 9.10822 0.489337 10.2974 1.51966C11.4866 2.54998 12.2413 3.99255 12.4097 5.55697C12.578 7.12139 12.1474 8.6915 11.2047 9.95123L11.0435 10.1665L12.2259 11.3489L12.4219 11.2595C12.8872 11.0473 13.4054 10.9791 13.9098 11.0637C14.4123 11.1479 14.8783 11.38 15.2484 11.7302L17.1761 13.7045L17.3982 13.4877L17.1812 13.7096C17.4183 13.9414 17.6067 14.2183 17.7354 14.524C17.864 14.8297 17.9303 15.158 17.9303 15.4896C17.9303 15.8212 17.864 16.1495 17.7354 16.4552C17.6067 16.7609 17.4183 17.0377 17.1812 17.2696L17.1789 17.2719C16.7121 17.7381 16.0793 18 15.4196 18ZM14.324 12.6065L16.3008 14.5833C16.4171 14.6988 16.51 14.8367 16.573 14.988C16.6361 15.1395 16.6687 15.3021 16.6687 15.4663C16.6687 15.6304 16.6361 15.793 16.573 15.9445C16.51 16.0957 16.4178 16.2329 16.3017 16.3484C16.1863 16.4645 16.049 16.5567 15.8979 16.6197C15.7463 16.6828 15.5838 16.7153 15.4196 16.7153C15.2554 16.7153 15.0929 16.6828 14.9413 16.6197C14.79 16.5566 14.6527 16.4643 14.5372 16.348L12.5598 14.3707C12.4436 14.2552 12.3507 14.1173 12.2876 13.966C12.2245 13.8144 12.192 13.6519 12.192 13.4877C12.192 13.3235 12.2245 13.161 12.2876 13.0094C12.3506 12.8583 12.4428 12.721 12.5589 12.6056C12.6744 12.4895 12.8116 12.3973 12.9628 12.3343C13.1143 12.2712 13.2769 12.2386 13.441 12.2386C13.6052 12.2386 13.7678 12.2712 13.9193 12.3343C14.0707 12.3974 14.2085 12.4901 14.324 12.6065ZM7.15467 11.1088C8.11973 10.9178 9.00653 10.445 9.70305 9.75027C10.1665 9.28796 10.5342 8.73877 10.7851 8.13414C11.036 7.5295 11.1652 6.88131 11.1652 6.22669C11.1652 5.57207 11.036 4.92388 10.7851 4.31925C10.5342 3.71461 10.1665 3.16542 9.70305 2.70312C9.00653 2.00836 8.11973 1.53561 7.15467 1.3446C6.18961 1.15359 5.18958 1.25288 4.28092 1.62993C3.37227 2.00699 2.59574 2.64488 2.04944 3.46304C1.50314 4.2812 1.21157 5.24291 1.21157 6.22669C1.21157 7.21047 1.50314 8.17219 2.04944 8.99035C2.59574 9.8085 3.37227 10.4464 4.28092 10.8235C5.18958 11.2005 6.18961 11.2998 7.15467 11.1088Z"
                                  fill="#C0C0C0"
                                ></path>
                              </svg>
                            </div>
                            <input type="text" class="form-control" v-model="profile_search"  placeholder="Search" />
                          </div>
                        </div>
                        <div class="employees-card-list">
                            <div v-for="(profile, index) in profilesListFilteredComputed" :key="index" @click="selectProfile(index)" class="employees-name-card" :class="{active: index == selectedIndexComputed }" >
                                <div class="tag">{{ profile.points }}</div>
                                <div class="info">
                                    <h3>{{ profile.full_name }}</h3>
                                    <h4>@{{ profile.citizen_id }}</h4>
                                </div>
                            </div>
                            <div v-if="showEmptyMessageSearch" class="no-data">
                              <div>
                                  <svg width="32" height="25"
                                      viewBox="0 0 32 25" fill="none" xmlns="http://www.w3.org/2000/svg">
                                      <path
                                          d="M15.822 12.6594L15.5858 12.8639L15.8704 12.9928C17.8117 13.8718 19.4587 15.2914 20.6146 17.0817C21.7704 18.8721 22.3862 20.9574 22.3882 23.0884C22.3882 23.4097 22.2605 23.7179 22.0333 23.9451C21.8061 24.1723 21.4978 24.3 21.1765 24.3C20.8551 24.3 20.5469 24.1723 20.3196 23.9451C20.0924 23.7178 19.9647 23.4096 19.9647 23.0882C19.9647 20.7887 19.0512 18.5833 17.4251 16.9572C15.7991 15.3312 13.5937 14.4176 11.2941 14.4176C8.99453 14.4176 6.78914 15.3312 5.16309 16.9572C3.53704 18.5833 2.62353 20.7887 2.62353 23.0882C2.62353 23.4096 2.49586 23.7178 2.26861 23.9451C2.04136 24.1723 1.73315 24.3 1.41176 24.3C1.09038 24.3 0.782167 24.1723 0.554918 23.9451C0.32769 23.7179 0.200025 23.4097 0.2 23.0883C0.202059 20.9573 0.817814 18.872 1.97364 17.0817C3.12949 15.2914 4.77652 13.8718 6.71779 12.9928L7.00245 12.8639L6.76619 12.6594C6.03459 12.0261 5.44779 11.2429 5.04561 10.3628C4.64343 9.48272 4.43528 8.52643 4.43529 7.55883C4.43529 5.73975 5.15792 3.99518 6.4442 2.7089C7.73048 1.42262 9.47504 0.7 11.2941 0.7C13.1132 0.7 14.8578 1.42262 16.144 2.7089C17.4303 3.99518 18.1529 5.73975 18.1529 7.55882C18.153 8.52643 17.9448 9.48272 17.5426 10.3628C17.1404 11.2429 16.5536 12.0261 15.822 12.6594ZM24.8952 12.1131L24.738 12.2901L24.9387 12.4155C26.747 13.5456 28.2362 15.1194 29.265 16.9872C30.2938 18.855 30.8278 20.9548 30.8165 23.0872V23.0882C30.8165 23.4096 30.6888 23.7178 30.4615 23.9451C30.2343 24.1723 29.9261 24.3 29.6047 24.3C29.2833 24.3 28.9751 24.1723 28.7479 23.9451C28.5207 23.718 28.3931 23.41 28.3929 23.0888C28.4079 21.1677 27.8737 19.2822 26.8532 17.6544C25.8334 16.0278 24.3704 14.7263 22.6362 13.9027L22.4655 13.8107L21.9227 13.4489L21.9217 13.4482C21.7498 13.3351 21.6095 13.1801 21.5141 12.9978C21.4188 12.8155 21.3714 12.612 21.3764 12.4064C21.3818 12.1991 21.4404 11.9966 21.5465 11.8184C21.6526 11.6402 21.8026 11.4922 21.9823 11.3885L21.9823 11.3885C22.6549 11.0002 23.2136 10.4422 23.6028 9.77024C23.992 9.09827 24.1979 8.33589 24.2 7.55936V7.55882C24.2 6.38251 23.7327 5.25438 22.9009 4.4226C22.0692 3.59082 20.941 3.12353 19.7647 3.12353C19.4433 3.12353 19.1351 2.99586 18.9079 2.76861L18.7664 2.91003L18.9079 2.76861C18.6806 2.54136 18.5529 2.23314 18.5529 1.91177C18.5529 1.59039 18.6806 1.28217 18.9079 1.05492L18.7664 0.913496L18.9079 1.05492C19.1351 0.827668 19.4433 0.7 19.7647 0.7L19.7648 0.7C21.0869 0.699647 22.3809 1.08142 23.4911 1.79936C24.6013 2.51731 25.4804 3.54082 26.0224 4.74671C26.5645 5.95259 26.7465 7.28944 26.5465 8.59634C26.3465 9.90324 25.773 11.1245 24.8952 12.1131ZM8.83 11.2466C9.55938 11.734 10.4169 11.9941 11.2941 11.9941C12.4704 11.9941 13.5986 11.5268 14.4303 10.6951C15.2621 9.86327 15.7294 8.73514 15.7294 7.55882C15.7294 6.68161 15.4693 5.82409 14.9819 5.09471C14.4946 4.36533 13.8019 3.79684 12.9914 3.46115C12.181 3.12545 11.2892 3.03762 10.4288 3.20875C9.56847 3.37989 8.77818 3.80231 8.15789 4.4226C7.5376 5.04288 7.11518 5.83318 6.94405 6.69354C6.77291 7.5539 6.86074 8.44569 7.19644 9.25614C7.53214 10.0666 8.10062 10.7593 8.83 11.2466Z"
                                          fill="#1B1B1B" fill-opacity="0.5" stroke="white"
                                          stroke-width="0.4" />
                                  </svg>  
                                  <h4>No Profiles</h4>
                              </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-9">
                        <div class="title-header">
                            <div class="row">
                                <div class="col-md-7">
                                    <div class="section-heading small green">
                                        <h4 class="ms-3"><svg width="15" height="18" viewBox="0 0 15 18" fill="none"
                                                xmlns="http://www.w3.org/2000/svg">
                                                <path
                                                    d="M4.5 7.2H5.4C5.63869 7.2 5.86761 7.10518 6.0364 6.9364C6.20518 6.76761 6.3 6.53869 6.3 6.3C6.3 6.06131 6.20518 5.83239 6.0364 5.6636C5.86761 5.49482 5.63869 5.4 5.4 5.4H4.5C4.2613 5.4 4.03239 5.49482 3.8636 5.6636C3.69482 5.83239 3.6 6.06131 3.6 6.3C3.6 6.53869 3.69482 6.76761 3.8636 6.9364C4.03239 7.10518 4.2613 7.2 4.5 7.2ZM4.5 9C4.2613 9 4.03239 9.09482 3.8636 9.2636C3.69482 9.43239 3.6 9.6613 3.6 9.9C3.6 10.1387 3.69482 10.3676 3.8636 10.5364C4.03239 10.7052 4.2613 10.8 4.5 10.8H9.9C10.1387 10.8 10.3676 10.7052 10.5364 10.5364C10.7052 10.3676 10.8 10.1387 10.8 9.9C10.8 9.6613 10.7052 9.43239 10.5364 9.2636C10.3676 9.09482 10.1387 9 9.9 9H4.5ZM14.4 6.246C14.3906 6.16332 14.3725 6.08187 14.346 6.003V5.922C14.3027 5.82946 14.245 5.7444 14.175 5.67L8.775 0.27C8.7006 0.199995 8.61554 0.142273 8.523 0.0989999C8.49613 0.0951841 8.46887 0.0951841 8.442 0.0989999C8.35057 0.0465671 8.2496 0.0129098 8.145 0H2.7C1.98392 0 1.29716 0.284464 0.790812 0.790812C0.284464 1.29716 0 1.98392 0 2.7V15.3C0 16.0161 0.284464 16.7028 0.790812 17.2092C1.29716 17.7155 1.98392 18 2.7 18H11.7C12.4161 18 13.1028 17.7155 13.6092 17.2092C14.1155 16.7028 14.4 16.0161 14.4 15.3V6.3V6.246ZM9 3.069L11.331 5.4H9.9C9.6613 5.4 9.43239 5.30518 9.2636 5.1364C9.09482 4.96761 9 4.73869 9 4.5V3.069ZM12.6 15.3C12.6 15.5387 12.5052 15.7676 12.3364 15.9364C12.1676 16.1052 11.9387 16.2 11.7 16.2H2.7C2.46131 16.2 2.23239 16.1052 2.0636 15.9364C1.89482 15.7676 1.8 15.5387 1.8 15.3V2.7C1.8 2.46131 1.89482 2.23239 2.0636 2.0636C2.23239 1.89482 2.46131 1.8 2.7 1.8H7.2V4.5C7.2 5.21608 7.48446 5.90284 7.99081 6.40919C8.49716 6.91554 9.18392 7.2 9.9 7.2H12.6V15.3ZM9.9 12.6H4.5C4.2613 12.6 4.03239 12.6948 3.8636 12.8636C3.69482 13.0324 3.6 13.2613 3.6 13.5C3.6 13.7387 3.69482 13.9676 3.8636 14.1364C4.03239 14.3052 4.2613 14.4 4.5 14.4H9.9C10.1387 14.4 10.3676 14.3052 10.5364 14.1364C10.7052 13.9676 10.8 13.7387 10.8 13.5C10.8 13.2613 10.7052 13.0324 10.5364 12.8636C10.3676 12.6948 10.1387 12.6 9.9 12.6Z"
                                                    fill="#1F1F1F" />
                                            </svg>
                                            Details</h4>

                                    </div>
                                </div>
                                <div class="col-md-5 header-buttons">
                     
                                    <button v-if="isAllowedToViewProfile" @click="profileDetail()"  class="btn btn-success">
                                      <svg width="19" height="18" viewBox="0 0 19 18"
                                            fill="none" xmlns="http://www.w3.org/2000/svg">
                                            <path fill-rule="evenodd" clip-rule="evenodd"
                                                d="M2.18417 0.0290213C2.70613 -0.0501408 3.23981 0.0335775 3.71246 0.268762L16.6247 6.72488H16.6328C17.0402 6.93879 17.3828 7.25845 17.6246 7.65063C17.8741 8.05551 18.0063 8.52176 18.0063 8.99736C18.0063 9.47297 17.8741 9.93922 17.6246 10.3441C17.3751 10.7489 17.0178 11.0765 16.593 11.2903L3.72235 17.7256C3.36182 17.9021 2.96642 17.9959 2.56502 18C2.13767 17.9997 1.71714 17.8927 1.3416 17.6888C0.965754 17.4846 0.646881 17.1898 0.413962 16.831C0.181043 16.4723 0.0414622 16.0611 0.00790565 15.6347C-0.0256445 15.2084 0.0479514 14.7802 0.221817 14.3895L2.42835 9.45251L2.43007 9.44842C2.48998 9.30559 2.52083 9.15225 2.52083 8.99736C2.52083 8.84248 2.49002 8.68912 2.43012 8.54629L0.221841 3.60528C0.00823425 3.12252 -0.051324 2.58564 0.0512877 2.0678C0.153922 1.54985 0.413801 1.07616 0.795493 0.711305C1.17718 0.346453 1.66211 0.108197 2.18417 0.0290213ZM15.939 9.98613L15.8516 9.81565L15.9373 9.98698L3.06268 16.4243C2.85844 16.5223 2.6291 16.5556 2.40541 16.5196C2.18172 16.4837 1.97438 16.3802 1.81118 16.223C1.64798 16.0659 1.53673 15.8626 1.49235 15.6404C1.44796 15.4182 1.47257 15.1878 1.56286 14.98L1.56354 14.9784L3.76007 10.0432L3.7605 10.0422C3.7858 9.98343 3.80766 9.92326 3.82597 9.86197L3.8668 9.72523H10.3443C10.5373 9.72523 10.7225 9.64854 10.859 9.51204C10.9955 9.37554 11.0722 9.19041 11.0722 8.99736C11.0722 8.80432 10.9955 8.61919 10.859 8.48269C10.7225 8.34619 10.5373 8.2695 10.3443 8.2695H3.8668L3.82597 8.13276C3.80766 8.07147 3.7858 8.0113 3.7605 7.95255L1.56286 3.01473C1.47257 2.80694 1.44796 2.57651 1.49235 2.35434C1.53673 2.13216 1.64798 1.92887 1.81118 1.77172C1.97438 1.61456 2.18172 1.51106 2.40541 1.47509C2.6291 1.43912 2.85844 1.4724 3.06268 1.57047L3.06543 1.57182L15.939 8.00859C16.121 8.10183 16.2737 8.24347 16.3803 8.41793C16.487 8.59239 16.5434 8.79289 16.5434 8.99736C16.5434 9.20184 16.487 9.40234 16.3803 9.5768C16.2737 9.75126 16.121 9.8929 15.939 9.98613Z"
                                                fill="white" />
                                      </svg>
                                      Profile Details
                                    </button>

                                </div>
                            </div>

                        </div>

                        <div class="col-md-5 header-buttons">
              
                            <button v-if="isAllowedToEditProfile" @click="editProfileBasicDetail()"  class="btn btn-success">
                              Edit Details
                            </button>

                        </div>

                        <div v-if="!showEmptyMessageSearchComputed" class="white-widget">
                            <div class="employee-info">
                                <div v-if="!isEditModeComputed" class="row">
                                    <div class="col-md-3">
                                        <label>Full Name</label>
                                        <div> {{ selectedProfile.full_name }}</div>
                                    </div>
                                    <div class="col-md-3">
                                        <label>Designation</label>
                                        <div>{{ selectedProfile.designation }}</div>
                                    </div>
                                    <div class="col-md-3">
                                        <label>Created At</label>
                                        <div>{{ selectedProfile.created_at }}</div>
                                    </div>
                                    <div class="col-md-3">
                                        <label>Address</label>
                                        <div>{{ selectedProfile.address }}</div>
                                    </div>
                                </div>
                                <div v-if="!isEditModeComputed" class="row">
                                    <div class="col-md-3">
                                        <label>Citizen ID</label>
                                        <div>{{ selectedProfile.citizen_id  }}
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <label>Finger Print</label>
                                        <div>{{ selectedProfile.finger_print }}</div>
                                    </div>
                                    <div class="col-md-3">
                                        <label>DNA Code</label>
                                        <div>{{ selectedProfile.dna_code }}</div>
                                    </div>
                                    <div class="col-md-3">
                                        <label>Points</label>
                                        <div>{{ selectedProfile.points }}</div>
                                    </div>
                                </div>
                                <div v-if="!isEditModeComputed" class="row">
                                    <div class="col-md-3">
                                        <label>Gender</label>
                                        <div>{{ selectedProfile.gender  }}
                                        </div>
                                    </div>
                                    <div class="col-md-3">
                                        <label>Age</label>
                                        <div>{{ selectedProfile.age }}</div>
                                    </div>
                                    <div class="col-md-3">
                                        <label>Created By</label>
                                        <div>{{ selectedProfile.creator_full_name }}</div>
                                    </div>
                                </div>
                            </div>

                        </div>
                        <div v-else class="no-data">
                          <div>
                              <svg width="32" height="25"
                                  viewBox="0 0 32 25" fill="none" xmlns="http://www.w3.org/2000/svg">
                                  <path
                                      d="M15.822 12.6594L15.5858 12.8639L15.8704 12.9928C17.8117 13.8718 19.4587 15.2914 20.6146 17.0817C21.7704 18.8721 22.3862 20.9574 22.3882 23.0884C22.3882 23.4097 22.2605 23.7179 22.0333 23.9451C21.8061 24.1723 21.4978 24.3 21.1765 24.3C20.8551 24.3 20.5469 24.1723 20.3196 23.9451C20.0924 23.7178 19.9647 23.4096 19.9647 23.0882C19.9647 20.7887 19.0512 18.5833 17.4251 16.9572C15.7991 15.3312 13.5937 14.4176 11.2941 14.4176C8.99453 14.4176 6.78914 15.3312 5.16309 16.9572C3.53704 18.5833 2.62353 20.7887 2.62353 23.0882C2.62353 23.4096 2.49586 23.7178 2.26861 23.9451C2.04136 24.1723 1.73315 24.3 1.41176 24.3C1.09038 24.3 0.782167 24.1723 0.554918 23.9451C0.32769 23.7179 0.200025 23.4097 0.2 23.0883C0.202059 20.9573 0.817814 18.872 1.97364 17.0817C3.12949 15.2914 4.77652 13.8718 6.71779 12.9928L7.00245 12.8639L6.76619 12.6594C6.03459 12.0261 5.44779 11.2429 5.04561 10.3628C4.64343 9.48272 4.43528 8.52643 4.43529 7.55883C4.43529 5.73975 5.15792 3.99518 6.4442 2.7089C7.73048 1.42262 9.47504 0.7 11.2941 0.7C13.1132 0.7 14.8578 1.42262 16.144 2.7089C17.4303 3.99518 18.1529 5.73975 18.1529 7.55882C18.153 8.52643 17.9448 9.48272 17.5426 10.3628C17.1404 11.2429 16.5536 12.0261 15.822 12.6594ZM24.8952 12.1131L24.738 12.2901L24.9387 12.4155C26.747 13.5456 28.2362 15.1194 29.265 16.9872C30.2938 18.855 30.8278 20.9548 30.8165 23.0872V23.0882C30.8165 23.4096 30.6888 23.7178 30.4615 23.9451C30.2343 24.1723 29.9261 24.3 29.6047 24.3C29.2833 24.3 28.9751 24.1723 28.7479 23.9451C28.5207 23.718 28.3931 23.41 28.3929 23.0888C28.4079 21.1677 27.8737 19.2822 26.8532 17.6544C25.8334 16.0278 24.3704 14.7263 22.6362 13.9027L22.4655 13.8107L21.9227 13.4489L21.9217 13.4482C21.7498 13.3351 21.6095 13.1801 21.5141 12.9978C21.4188 12.8155 21.3714 12.612 21.3764 12.4064C21.3818 12.1991 21.4404 11.9966 21.5465 11.8184C21.6526 11.6402 21.8026 11.4922 21.9823 11.3885L21.9823 11.3885C22.6549 11.0002 23.2136 10.4422 23.6028 9.77024C23.992 9.09827 24.1979 8.33589 24.2 7.55936V7.55882C24.2 6.38251 23.7327 5.25438 22.9009 4.4226C22.0692 3.59082 20.941 3.12353 19.7647 3.12353C19.4433 3.12353 19.1351 2.99586 18.9079 2.76861L18.7664 2.91003L18.9079 2.76861C18.6806 2.54136 18.5529 2.23314 18.5529 1.91177C18.5529 1.59039 18.6806 1.28217 18.9079 1.05492L18.7664 0.913496L18.9079 1.05492C19.1351 0.827668 19.4433 0.7 19.7647 0.7L19.7648 0.7C21.0869 0.699647 22.3809 1.08142 23.4911 1.79936C24.6013 2.51731 25.4804 3.54082 26.0224 4.74671C26.5645 5.95259 26.7465 7.28944 26.5465 8.59634C26.3465 9.90324 25.773 11.1245 24.8952 12.1131ZM8.83 11.2466C9.55938 11.734 10.4169 11.9941 11.2941 11.9941C12.4704 11.9941 13.5986 11.5268 14.4303 10.6951C15.2621 9.86327 15.7294 8.73514 15.7294 7.55882C15.7294 6.68161 15.4693 5.82409 14.9819 5.09471C14.4946 4.36533 13.8019 3.79684 12.9914 3.46115C12.181 3.12545 11.2892 3.03762 10.4288 3.20875C9.56847 3.37989 8.77818 3.80231 8.15789 4.4226C7.5376 5.04288 7.11518 5.83318 6.94405 6.69354C6.77291 7.5539 6.86074 8.44569 7.19644 9.25614C7.53214 10.0666 8.10062 10.7593 8.83 11.2466Z"
                                      fill="#1B1B1B" fill-opacity="0.5" stroke="white"
                                      stroke-width="0.4" />
                              </svg>  
                              <h4>No Profiles</h4>
                        </div>
                        </div>
                    </div>
                </div>

            </div>
            <div v-else class="no-data">
                <div>
                    <svg width="32" height="25"
                        viewBox="0 0 32 25" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M15.822 12.6594L15.5858 12.8639L15.8704 12.9928C17.8117 13.8718 19.4587 15.2914 20.6146 17.0817C21.7704 18.8721 22.3862 20.9574 22.3882 23.0884C22.3882 23.4097 22.2605 23.7179 22.0333 23.9451C21.8061 24.1723 21.4978 24.3 21.1765 24.3C20.8551 24.3 20.5469 24.1723 20.3196 23.9451C20.0924 23.7178 19.9647 23.4096 19.9647 23.0882C19.9647 20.7887 19.0512 18.5833 17.4251 16.9572C15.7991 15.3312 13.5937 14.4176 11.2941 14.4176C8.99453 14.4176 6.78914 15.3312 5.16309 16.9572C3.53704 18.5833 2.62353 20.7887 2.62353 23.0882C2.62353 23.4096 2.49586 23.7178 2.26861 23.9451C2.04136 24.1723 1.73315 24.3 1.41176 24.3C1.09038 24.3 0.782167 24.1723 0.554918 23.9451C0.32769 23.7179 0.200025 23.4097 0.2 23.0883C0.202059 20.9573 0.817814 18.872 1.97364 17.0817C3.12949 15.2914 4.77652 13.8718 6.71779 12.9928L7.00245 12.8639L6.76619 12.6594C6.03459 12.0261 5.44779 11.2429 5.04561 10.3628C4.64343 9.48272 4.43528 8.52643 4.43529 7.55883C4.43529 5.73975 5.15792 3.99518 6.4442 2.7089C7.73048 1.42262 9.47504 0.7 11.2941 0.7C13.1132 0.7 14.8578 1.42262 16.144 2.7089C17.4303 3.99518 18.1529 5.73975 18.1529 7.55882C18.153 8.52643 17.9448 9.48272 17.5426 10.3628C17.1404 11.2429 16.5536 12.0261 15.822 12.6594ZM24.8952 12.1131L24.738 12.2901L24.9387 12.4155C26.747 13.5456 28.2362 15.1194 29.265 16.9872C30.2938 18.855 30.8278 20.9548 30.8165 23.0872V23.0882C30.8165 23.4096 30.6888 23.7178 30.4615 23.9451C30.2343 24.1723 29.9261 24.3 29.6047 24.3C29.2833 24.3 28.9751 24.1723 28.7479 23.9451C28.5207 23.718 28.3931 23.41 28.3929 23.0888C28.4079 21.1677 27.8737 19.2822 26.8532 17.6544C25.8334 16.0278 24.3704 14.7263 22.6362 13.9027L22.4655 13.8107L21.9227 13.4489L21.9217 13.4482C21.7498 13.3351 21.6095 13.1801 21.5141 12.9978C21.4188 12.8155 21.3714 12.612 21.3764 12.4064C21.3818 12.1991 21.4404 11.9966 21.5465 11.8184C21.6526 11.6402 21.8026 11.4922 21.9823 11.3885L21.9823 11.3885C22.6549 11.0002 23.2136 10.4422 23.6028 9.77024C23.992 9.09827 24.1979 8.33589 24.2 7.55936V7.55882C24.2 6.38251 23.7327 5.25438 22.9009 4.4226C22.0692 3.59082 20.941 3.12353 19.7647 3.12353C19.4433 3.12353 19.1351 2.99586 18.9079 2.76861L18.7664 2.91003L18.9079 2.76861C18.6806 2.54136 18.5529 2.23314 18.5529 1.91177C18.5529 1.59039 18.6806 1.28217 18.9079 1.05492L18.7664 0.913496L18.9079 1.05492C19.1351 0.827668 19.4433 0.7 19.7647 0.7L19.7648 0.7C21.0869 0.699647 22.3809 1.08142 23.4911 1.79936C24.6013 2.51731 25.4804 3.54082 26.0224 4.74671C26.5645 5.95259 26.7465 7.28944 26.5465 8.59634C26.3465 9.90324 25.773 11.1245 24.8952 12.1131ZM8.83 11.2466C9.55938 11.734 10.4169 11.9941 11.2941 11.9941C12.4704 11.9941 13.5986 11.5268 14.4303 10.6951C15.2621 9.86327 15.7294 8.73514 15.7294 7.55882C15.7294 6.68161 15.4693 5.82409 14.9819 5.09471C14.4946 4.36533 13.8019 3.79684 12.9914 3.46115C12.181 3.12545 11.2892 3.03762 10.4288 3.20875C9.56847 3.37989 8.77818 3.80231 8.15789 4.4226C7.5376 5.04288 7.11518 5.83318 6.94405 6.69354C6.77291 7.5539 6.86074 8.44569 7.19644 9.25614C7.53214 10.0666 8.10062 10.7593 8.83 11.2466Z"
                            fill="#1B1B1B" fill-opacity="0.5" stroke="white"
                            stroke-width="0.4" />
                    </svg>  
                    <h4>No Profiles</h4>
                </div>
            </div>
            <!-- <delete-user-modal :show-modal="showDeleteModalComputed" :user-id="userIdToDeleteComputed" @close="closeDeleteModal" /> -->
            <add-new-profile-modal :show-modal="showAddModalComputed" :profile-id='selectedProfileIdComputed' :selected-profile="selectedProfileComputed" @close="closeAddModal" />
        </div>
    </div>
</template>

<script>
import { mapGetters } from 'vuex'
import { required, minLength } from 'vuelidate/lib/validators'
import DeleteUserModal from '~/components/users/DeleteUserModal.vue'
import AddNewUserModal from '~/components/users/AddNewUserModal.vue'
import AddNewProfileModal from '~/components/profile/AddNewProfileModal.vue'
export default {
  components: { DeleteUserModal, AddNewUserModal, AddNewProfileModal },
  name: 'Persons',
  layout: 'master',
  middleware: ['profileMW'],
  data () {
    return {
      profilesList: [],
      profilesListFiltered: [],
      selectedIndex: 0,
      selectedProfile: [],
      isEditMode: false,
      isDeleteModalOpen: false,
      isAddModalOpen: false,
      userIdToDelete: 0,
      showEmptyMessage: false,
      showEmptyMessageSearch: false,
      profile_search: '',
      profileId: null,
    }
  },
  validations: {
    selectedProfile: {
      full_name: {
        required
      },
     username: {
        required
      },
     citizen_id: {
        required
      },
     profile_picture: {
        required
      },
     enc_department_id: {
        required
      },
     enc_rank_id: {
        required
      },
     call_sign: {
        required
      },
    }
  },
  watch: {
    profile_search(newValue, oldValue){
      if(newValue.length > 2){
          this.searchPersons(newValue)
      }else {

        this.profilesListFiltered = this.profilesList

        if(this.profilesListFiltered.length > 0) {
          this.selectedProfile = this.profilesListFiltered[0]
          this.showEmptyMessageSearch = false
        }else {
          this.showEmptyMessageSearch = true
        }

      }
    }

  },
  computed: {
    selectedProfileIdComputed () {
      return this.profileId
    },
    selectedProfileComputed () {
      return this.selectedProfile
    },
    profilesListComputed() {
      return this.profilesList
    },
    profilesListFilteredComputed() {
      return this.profilesListFiltered
    },
    selectedIndexComputed() {
      return this.selectedIndex
    },
    isEditModeComputed() {
      return this.isEditMode
    },
    showDeleteModalComputed() {
      return this.isDeleteModalOpen
    },
    showAddModalComputed() {
      return this.isAddModalOpen
    },
     userIdToDeleteComputed() {
      return this.userIdToDelete
    },
    showEmptyMessageSearchComputed() {
      return this.showEmptyMessageSearch
    },
    ...mapGetters([ 'getRanks', 'getDepartments']),
    ...mapGetters({
      isAllowedToCreateProfile: 'auth/isAllowedToCreateProfile',
      isAllowedToViewProfile: 'auth/isAllowedToViewProfile',
      isAllowedToEditProfile: 'auth/isAllowedToEditProfile',
    })
  },
  mounted () {
    this.$store.commit('setActiveTab', 'search')
    this.fetchAllProfiles()
  },
  methods: {
    async fetchAllProfiles(){
      this.profilesList = await this.$store.dispatch(
        'profile/fetchAllProfiles',
        {}
      )
      this.profilesListFiltered = this.profilesList
      if(this.profilesListFiltered.length > 0) {
        this.selectedProfile = this.profilesListFiltered[0]
      }else {
        this.showEmptyMessage = true
      }

    },
    selectProfile(index) {
      this.selectedIndex = index
      this.selectedProfile = this.profilesListFiltered[index]
      this.isEditMode =  false
    },
    editProfile() {
      this.isEditMode = true
    },
    editProfileBasicDetail () {
      this.profileId = true
      this.isAddModalOpen = true
    },
    closeDeleteModal() {
      this.userIdToDelete = 0
      this.isDeleteModalOpen = false
      this.fetchAllUsers()
      this.selectProfile(0)

    },

    addNewProfile() {
      this.isAddModalOpen = true
    },
    closeAddModal() {
      this.profileId = false
      this.isAddModalOpen = false
      this.fetchAllProfiles()
      this.selectProfile(0)

    },
    profileDetail() {
        this.$router.push({ path: 'profile', query: { profile_id: this.selectedProfile.profile_id } })
    },

    searchPersons(searchedName) {
      this.showEmptyMessageSearch = false
      searchedName = searchedName.toLowerCase()
      var list = this.profilesList

      const filtered = list.filter( (
            profile,
            index,
            array
        ) => {
            let name = profile.full_name.toLowerCase()
            if (name.includes(searchedName)) {
            return true
            } else {
            return false
            }
        })
        this.profilesListFiltered = filtered

        if(this.profilesListFiltered.length > 0) {
          this.selectedProfile = this.profilesListFiltered[0]
          this.$store.commit('profile/pushNewSearchprofile',this.selectedProfile)
        }else {
          this.showEmptyMessageSearch = true
        }
    }

  }
}
</script>

<style lang="css" scoped>
  .page-title-banner.users {
      background: url(~/assets/images/users-banner.png) no-repeat;
      background-size: 100% !important;   
  }
  .header-buttons {
      text-align: right;
      margin-top: 15px;
  }
  .header-buttons .btn {
      font-weight: normal;
  }
  .employee-info label {
      color: rgba(27, 27, 27, 0.5);
  }
  .employee-info .row {
      margin-bottom: 20px;
  }

  .role-widget > h4 {
      font-size: 18px;
      font-weight: normal;
      margin-bottom: 15px;
      color: rgba(27, 27, 27, 0.5);
  }

.page-title-banner .cover-btns {
    align-self: flex-end;
    margin-left: auto;
    text-align: right;
}
.page-title-banner .cover-btns  .btn {
    min-width:150px;
    margin-left: 5px;
}
</style>
